{"pageProps":{"post":{"title":"Share Rust Types With TypeScript for WebAssembly in 30 Seconds","publishedAt":"May 29, 2023","description":"Discover the most seamless developer experience with Rust and WebAssembly. This is the fastest way to auto-generate TypeScript definitions from your Rust code.","cover":"/optimized/articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds/hero.webp","category":"Rust","coverWidth":"1400","coverHeight":"700","body":{"raw":"\n## In this article\n\n- üí° We'll learn why the official Rust and WebAssembly toolchain is not sufficient for TypeScript.\n- ü§π I'll show you how to auto-generate TypeScript definition with minimum change in your Rust code.\n- üß™ We'll refactor a real world WebAssembly library on npm together.\n\nLet's go.\n\n---\n\n## The Typing Problem with wasm-bindgen\n\nGenerating TypeScript types for WebAssembly(Wasm) modules in Rust is not straightforward.\n\nI ran into the problem when I was working on a vector similarity search engine in Wasm called [Voy][8]. I built the Wasm engine in Rust to provide JavaScript and TypeScript engineers with a swiss knife for semantic search. Here's a demo for web:\n\n<img\n  src=\"/articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds/voy.gif\"\n  alt=\"Voy demo\"\n  width=\"100%\"\n  className=\"rounded centered\"\n  loading=\"lazy\"\n/>\n\n> You can find the [Voy's repository on GitHub][7]! Feel free to try it out.\n>\n> The repository includes [examples](https://github.com/tantaraio/voy/tree/main/examples) that you can see how to use Voy in different frameworks.\n\nI used [wasm-pack][9] and [wasm-bindgen][10] to build and compile the Rust code to Wasm. The generated TypeScript definitions looks like this:\n\n```ts:pkg/voy_search.d.ts\n/* tslint:disable */\n/* eslint-disable */\n/**\n * @param {any} input\n * @returns {string}\n */\nexport function index(resource: any): string\n/**\n * @param {string} index\n * @param {any} query\n * @param {number} k\n * @returns {any}\n */\nexport function search(index: string, query: any, k: number): any\n```\n\nAs you can see, there're a lot of \"any\" type, which is not very helpful for the developer experience. Let's look into the Rust code to find out what happened.\n\n```rust:src/lib.rs\ntype NumberOfResult = usize;\ntype Embeddings = Vec<f32>;\ntype SerializedIndex = String;\n\n#[derive(Serialize, Deserialize, Debug)]\npub struct EmbeddedResource {\n    id: String,\n    title: String,\n    url: String,\n    embeddings: Embeddings,\n}\n\n#[derive(Serialize, Deserialize, Debug)]\npub struct Resource {\n    pub embeddings: Vec<EmbeddedResource>,\n}\n\n#[wasm_bindgen]\npub fn index(resource: JsValue) -> SerializedIndex { /* snip */ }\n\n#[wasm_bindgen]\npub fn search(index: &str, query: JsValue, k: NumberOfResult) -> JsValue {\n    // snip\n}\n```\n\nThe string, slice, and unsigned integer generated the correct types in TypeScript, but the \"[wasm_bindgen::JsValue][11]\" didn't. JsValue is wasm-bindgen's representation of a JavaScript object. We [serialize and deserialize][12] the JsValue to pass it back and forth between JavaScript and Rust through Wasm.\n\n```rust\n#[wasm_bindgen]\npub fn index(resource: JsValue) -> String {\n    // üí° Deserialize JsValue in to Resource struct in Rust\n    let resource: Resource = serde_wasm_bindgen:from_value(input).unwrap();\n    // snip\n}\n\n#[wasm_bindgen]\npub fn search(index: &str, query: JsValue, k: usize) -> JsValue {\n    // snip\n    // üí° Serialize search result into JsValue and pass it to WebAssembly\n    let result = engine::search(&index, &query, k).unwrap();\n    serde_wasm_bindgen:to_value(&result).unwrap()\n}\n```\n\nIt's the official approach to convert data types, but evidently we need to go the extra mile to support TypeScript.\n\n## Auto-Generate TypeScript Binding with Tsify\n\nConverting data types from one language to another is actually a common pattern called [Foreign function interface][13](FFI). I explored FFI tools like [Typeshare][4] to auto-generate TypeScript definitions from Rust structs but it was only half of the solution. What we need is a way to tap into the Wasm compilation and generate the type definition for the API of the Wasm module. Like this:\n\n```rust\n#[wasm_bindgen]\npub fn index(resource: Resource) -> SerializedIndex { /* snip */ }\n\n#[wasm_bindgen]\npub fn search(index: SerializedIndex, query: Embeddings, k: NumberOfResult) -> SearchResult {\n    // snip\n}\n```\n\nLuckily, [Tsify][2] is an amazing open source library for the use case. All we need to do is to derive from the \"Tsify\" trait and add a #\\[tsify\\] macro to the structs:\n\n```rust:src/lib.rs\ntype NumberOfResult = usize;\ntype Embeddings = Vec<f32>;\ntype SerializedIndex = String;\n\n#[derive(Serialize, Deserialize, Debug, Clone, Tsify)]\n#[tsify(from_wasm_abi)]\npub struct EmbeddedResource {\n    pub id: String,\n    pub title: String,\n    pub url: String,\n    pub embeddings: Embeddings,\n}\n\n#[derive(Serialize, Deserialize, Debug, Tsify)]\n#[tsify(from_wasm_abi)]\npub struct Resource {\n    pub embeddings: Vec<EmbeddedResource>,\n}\n\n#[derive(Serialize, Deserialize, Debug, Clone, Tsify)]\n#[tsify(into_wasm_abi)]\npub struct Neighbor {\n    pub id: String,\n    pub title: String,\n    pub url: String,\n}\n\n#[derive(Serialize, Deserialize, Debug, Clone, Tsify)]\n#[tsify(into_wasm_abi)]\npub struct SearchResult {\n    neighbors: Vec<Neighbor>,\n}\n\n#[wasm_bindgen]\npub fn index(resource: Resource) -> SerializedIndex { /* snip */ }\n\n#[wasm_bindgen]\npub fn search(index: SerializedIndex, query: Embeddings, k: NumberOfResult) -> SearchResult {\n    // snip\n}\n```\n\nThat's it! Let's take a look at the attributes \"from_wasm_abi\" and \"into_wasm_abi\".\n\n<img\n  src=\"/optimized/articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds/wasm-abi.webp\"\n  alt=\"Wasm ABI illustration\"\n  width=\"100%\"\n  className=\"rounded centered\"\n  loading=\"lazy\"\n/>\n\nBoth of the attributes convert Rust data type to TypeScript definition. What they do differently is the direction of the data flow with Wasm's Application Binary Interface(ABI).\n\n- **into_wasm_abi**: The data flows from Rust to JavaScript. Used for return type.\n- **from_wasm_abi**: The data flows from JavaScript to Rust. Used for parameters.\n\nBoth of the attributes use serde-wasm-bindgen to implement the data conversion between Rust and JavaScript.\n\nWe're ready to build the Wasm module. Once you run \"wasm-pack build\", the auto-generated TypeScript definition:\n\n```ts:pkg/voy_search.d.ts\n/* tslint:disable */\n/* eslint-disable */\n/**\n * @param {Resource} resource\n * @returns {string}\n */\nexport function index(resource: Resource): string\n/**\n * @param {string} index\n * @param {Float32Array} query\n * @param {number} k\n * @returns {SearchResult}\n */\nexport function search(\n  index: string,\n  query: Float32Array,\n  k: number\n): SearchResult\n\nexport interface EmbeddedResource {\n  id: string\n  title: string\n  url: string\n  embeddings: number[]\n}\n\nexport interface Resource {\n  embeddings: EmbeddedResource[]\n}\n\nexport interface Neighbor {\n  id: string\n  title: string\n  url: string\n}\n\nexport interface SearchResult {\n  neighbors: Neighbor[]\n}\n```\n\nAll the \"any\" types are replaced with the interfaces that we defined in the Rust code‚ú®\n\n> Special thanks to [Alberto Schiabel][14] for sharing valuable insights that helped me research type generation.\n\n\n## Final Thoughts\n\nThe generated types look good but there's some inconsistencies. If you look closely, you'll notice the query parameter in the search function is defined as a Float32Array. The query parameter is defined as the same type as \"embeddings\" in EmbeddedResource so I expect them to have the same type in TypeScript. If you know why they're converted to different types please don't hesitate to reach out or open a pull request in [Voy on GitHub][7].\n\n[Voy][7] is an open source semantic search engine in WebAssembly. I created it to empower more projects to build semantic features and create better user experiences for people around the world. Voy follows several design principles:\n\n- ü§è **Tiny**: Reduce overhead for limited devices, such as mobile browsers with slow network or IoT.\n- üöÄ **Fast**: Create the best search experience for the users.\n- üå≥ **Tree Shakable**: Optimize bundle size and enable asynchronous capabilities for modern Web API, such as Web Workers.\n- üîã **Resumable**: Generate portable embeddings index anywhere, anytime.\n- ‚òÅÔ∏è **Worldwide**: Run semantic search on CDN edge servers.\n\nIt's available on npm. You can simply install it with your favorite package manager and you're ready to go.\n\n```bash\n# with npm\nnpm i voy-search\n\n# with Yarn\nyarn add voy-search\n\n# with pnpm\npnpm add voy-search\n```\n\nGive it a try and I'm happy to hear from you!\n\n## References\n\n- [Foreign function interface][13] - Wikipedia\n- [serde-wasm-bindgen][12] - GitHub\n- [Specta][3] - GitHub\n- [Struct wasm_bindgen::JsValue][11] - wasm-bindgen\n- [The Rust and WebAssembly Book][6] - Rust and WebAssembly\n- [ts-rs][5] - GitHub\n- [Tsify][2] - GitHub\n- [Typeshare][4] - GitHub\n- [Voy][7] - GitHub\n- [wasm-bindgen][10] - Rust and WebAssembly\n- [wasm-pack][9] - Rust and WebAssembly\n- [WASM Semantic Search in Rust][8] - Daw-Chih Liou\n- [WebAssembly][1] - WebAssembly.org\n\n[1]: https://webassembly.org\n[2]: https://github.com/madonoharu/tsify\n[3]: https://github.com/oscartbeaumont/specta\n[4]: https://github.com/1Password/typeshare\n[5]: https://github.com/Aleph-Alpha/ts-rs\n[6]: https://rustwasm.github.io/docs/book/introduction.html\n[7]: https://github.com/tantaraio/voy\n[8]: https://dawchihliou.github.io/articles/wasm-semantic-search-in-rust\n[9]: https://rustwasm.github.io/wasm-pack/\n[10]: https://rustwasm.github.io/wasm-bindgen/\n[11]: https://rustwasm.github.io/wasm-bindgen/api/wasm_bindgen/struct.JsValue.html\n[12]: https://github.com/cloudflare/serde-wasm-bindgen\n[13]: https://en.wikipedia.org/wiki/Foreign_function_interface\n[14]: https://twitter.com/jkomyno\n\n---\n\nHere you have it! Thanks for reading through üôå\nIf you find this article useful, please share it to help more people in their engineering journey.\n\nüê¶ Feel free to connect with me on [twitter](https://twitter.com/dawchihliou)!\n\n‚è≠Ô∏è Ready for the next article? üëâ [The Last Dockerfile You Need for NestJS](/articles/the-last-dockerfile-you-need-for-nestjs)\n\nHappy coding!\n","code":"var Component=(()=>{var p=Object.create;var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var k=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),b=(a,e)=>{for(var s in e)l(a,s,{get:e[s],enumerable:!0})},t=(a,e,s,i)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of m(e))!N.call(a,c)&&c!==s&&l(a,c,{get:()=>e[c],enumerable:!(i=h(e,c))||i.enumerable});return a};var y=(a,e,s)=>(s=a!=null?p(u(a)):{},t(e||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),g=a=>t(l({},\"__esModule\",{value:!0}),a);var o=k((x,r)=>{r.exports=_jsx_runtime});var v={};b(v,{default:()=>S,frontmatter:()=>f});var n=y(o()),f={title:\"Share Rust Types With TypeScript for WebAssembly in 30 Seconds\",publishedAt:\"May 29, 2023\",description:\"Discover the most seamless developer experience with Rust and WebAssembly. This is the fastest way to auto-generate TypeScript definitions from your Rust code.\",cover:\"/optimized/articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds/hero.webp\",category:\"Rust\",coverWidth:\"1400\",coverHeight:\"700\"};function d(a){let e=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",ul:\"ul\",li:\"li\",p:\"p\",hr:\"hr\",blockquote:\"blockquote\",div:\"div\",pre:\"pre\",code:\"code\",strong:\"strong\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"in-this-article\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#in-this-article\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"In this article\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"light bulb\",children:\"\\u{1F4A1}\"}),\" We'll learn why the official Rust and WebAssembly toolchain is not sufficient for TypeScript.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"\",\"aria-hidden\":!0,children:\"\\u{1F939}\"}),\" I'll show you how to auto-generate TypeScript definition with minimum change in your Rust code.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"\",\"aria-hidden\":!0,children:\"\\u{1F9EA}\"}),\" We'll refactor a real world WebAssembly library on npm together.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Let's go.\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"the-typing-problem-with-wasm-bindgen\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#the-typing-problem-with-wasm-bindgen\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"The Typing Problem with wasm-bindgen\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Generating TypeScript types for WebAssembly(Wasm) modules in Rust is not straightforward.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"I ran into the problem when I was working on a vector similarity search engine in Wasm called \",(0,n.jsx)(e.a,{href:\"https://dawchihliou.github.io/articles/wasm-semantic-search-in-rust\",children:\"Voy\"}),\". I built the Wasm engine in Rust to provide JavaScript and TypeScript engineers with a swiss knife for semantic search. Here's a demo for web:\"]}),`\n`,(0,n.jsx)(\"img\",{src:\"/articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds/voy.gif\",alt:\"Voy demo\",width:\"100%\",className:\"rounded centered\",loading:\"lazy\"}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"You can find the \",(0,n.jsx)(e.a,{href:\"https://github.com/tantaraio/voy\",children:\"Voy's repository on GitHub\"}),\"! Feel free to try it out.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The repository includes \",(0,n.jsx)(e.a,{href:\"https://github.com/tantaraio/voy/tree/main/examples\",children:\"examples\"}),\" that you can see how to use Voy in different frameworks.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"I used \",(0,n.jsx)(e.a,{href:\"https://rustwasm.github.io/wasm-pack/\",children:\"wasm-pack\"}),\" and \",(0,n.jsx)(e.a,{href:\"https://rustwasm.github.io/wasm-bindgen/\",children:\"wasm-bindgen\"}),\" to build and compile the Rust code to Wasm. The generated TypeScript definitions looks like this:\"]}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"pkg/voy_search.d.ts\"}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"language-ts code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* tslint:disable */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* eslint-disable */\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`/**\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {any} input\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @returns {string}\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\" */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"index\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"any\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`/**\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {string} index\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {any} query\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {number} k\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @returns {any}\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\" */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" query\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"any\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"any\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:`As you can see, there're a lot of \"any\" type, which is not very helpful for the developer experience. Let's look into the Rust code to find out what happened.`}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"src/lib.rs\"}),(0,n.jsx)(e.pre,{className:\"language-rust\",children:(0,n.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"NumberOfResult\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"usize\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"Embeddings\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Vec\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"f32\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"SerializedIndex\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[derive(Serialize, Deserialize, Debug)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"EmbeddedResource\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    title\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    embeddings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Embeddings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[derive(Serialize, Deserialize, Debug)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"Resource\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" embeddings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Vec\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"EmbeddedResource\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"index\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JsValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SerializedIndex\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* snip */\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" query\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JsValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"NumberOfResult\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JsValue\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// snip\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:['The string, slice, and unsigned integer generated the correct types in TypeScript, but the \"',(0,n.jsx)(e.a,{href:\"https://rustwasm.github.io/wasm-bindgen/api/wasm_bindgen/struct.JsValue.html\",children:\"wasm_bindgen::JsValue\"}),`\" didn't. JsValue is wasm-bindgen's representation of a JavaScript object. We `,(0,n.jsx)(e.a,{href:\"https://github.com/cloudflare/serde-wasm-bindgen\",children:\"serialize and deserialize\"}),\" the JsValue to pass it back and forth between JavaScript and Rust through Wasm.\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-rust\",children:(0,n.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"index\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JsValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token comment\",children:[\"// \",(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"light bulb\",children:\"\\u{1F4A1}\"}),\" Deserialize JsValue in to Resource struct in Rust\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Resource\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" serde_wasm_bindgen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"from_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"input\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"unwrap\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// snip\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"str\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" query\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JsValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"usize\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JsValue\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// snip\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token comment\",children:[\"// \",(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"light bulb\",children:\"\\u{1F4A1}\"}),\" Serialize search result into JsValue and pass it to WebAssembly\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" result \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"engine\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"::\"})]}),(0,n.jsx)(e.span,{className:\"token function\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"index\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"query\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"unwrap\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    serde_wasm_bindgen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"to_value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"unwrap\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"It's the official approach to convert data types, but evidently we need to go the extra mile to support TypeScript.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"auto-generate-typescript-binding-with-tsify\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#auto-generate-typescript-binding-with-tsify\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Auto-Generate TypeScript Binding with Tsify\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Converting data types from one language to another is actually a common pattern called \",(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Foreign_function_interface\",children:\"Foreign function interface\"}),\"(FFI). I explored FFI tools like \",(0,n.jsx)(e.a,{href:\"https://github.com/1Password/typeshare\",children:\"Typeshare\"}),\" to auto-generate TypeScript definitions from Rust structs but it was only half of the solution. What we need is a way to tap into the Wasm compilation and generate the type definition for the API of the Wasm module. Like this:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-rust\",children:(0,n.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"index\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Resource\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SerializedIndex\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* snip */\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SerializedIndex\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" query\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Embeddings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"NumberOfResult\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SearchResult\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// snip\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Luckily, \",(0,n.jsx)(e.a,{href:\"https://github.com/madonoharu/tsify\",children:\"Tsify\"}),' is an amazing open source library for the use case. All we need to do is to derive from the \"Tsify\" trait and add a #[tsify] macro to the structs:']}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"src/lib.rs\"}),(0,n.jsx)(e.pre,{className:\"language-rust\",children:(0,n.jsxs)(e.code,{className:\"language-rust code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"NumberOfResult\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"usize\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"Embeddings\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Vec\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"f32\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"SerializedIndex\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[derive(Serialize, Deserialize, Debug, Clone, Tsify)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[tsify(from_wasm_abi)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"EmbeddedResource\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" title\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" embeddings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Embeddings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[derive(Serialize, Deserialize, Debug, Tsify)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[tsify(from_wasm_abi)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"Resource\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" embeddings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Vec\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"EmbeddedResource\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[derive(Serialize, Deserialize, Debug, Clone, Tsify)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[tsify(into_wasm_abi)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"Neighbor\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" title\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[derive(Serialize, Deserialize, Debug, Clone, Tsify)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[tsify(into_wasm_abi)]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token type-definition class-name\",children:\"SearchResult\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    neighbors\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Vec\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Neighbor\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"index\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Resource\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SerializedIndex\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* snip */\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token attribute attr-name\",children:\"#[wasm_bindgen]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"pub\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"fn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-definition function\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"index\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SerializedIndex\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" query\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Embeddings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"NumberOfResult\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"->\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SearchResult\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// snip\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:`That's it! Let's take a look at the attributes \"from_wasm_abi\" and \"into_wasm_abi\".`}),`\n`,(0,n.jsx)(\"img\",{src:\"/optimized/articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds/wasm-abi.webp\",alt:\"Wasm ABI illustration\",width:\"100%\",className:\"rounded centered\",loading:\"lazy\"}),`\n`,(0,n.jsx)(e.p,{children:\"Both of the attributes convert Rust data type to TypeScript definition. What they do differently is the direction of the data flow with Wasm's Application Binary Interface(ABI).\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"into_wasm_abi\"}),\": The data flows from Rust to JavaScript. Used for return type.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"from_wasm_abi\"}),\": The data flows from JavaScript to Rust. Used for parameters.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Both of the attributes use serde-wasm-bindgen to implement the data conversion between Rust and JavaScript.\"}),`\n`,(0,n.jsx)(e.p,{children:`We're ready to build the Wasm module. Once you run \"wasm-pack build\", the auto-generated TypeScript definition:`}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"pkg/voy_search.d.ts\"}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"language-ts code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* tslint:disable */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* eslint-disable */\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`/**\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {Resource} resource\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @returns {string}\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\" */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"index\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" Resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`/**\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {string} index\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {Float32Array} query\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @param {number} k\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` * @returns {SearchResult}\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\" */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"search\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  index\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  query\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" Float32Array\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  k\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"number\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),` SearchResult\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"EmbeddedResource\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  id\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  title\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  url\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  embeddings\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Resource\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  embeddings\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" EmbeddedResource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Neighbor\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  id\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  title\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  url\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SearchResult\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  neighbors\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" Neighbor\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:['All the \"any\" types are replaced with the interfaces that we defined in the Rust code',(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"sparkles\",children:\"\\u2728\"})]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Special thanks to \",(0,n.jsx)(e.a,{href:\"https://twitter.com/jkomyno\",children:\"Alberto Schiabel\"}),\" for sharing valuable insights that helped me research type generation.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"final-thoughts\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#final-thoughts\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Final Thoughts\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`The generated types look good but there's some inconsistencies. If you look closely, you'll notice the query parameter in the search function is defined as a Float32Array. The query parameter is defined as the same type as \"embeddings\" in EmbeddedResource so I expect them to have the same type in TypeScript. If you know why they're converted to different types please don't hesitate to reach out or open a pull request in `,(0,n.jsx)(e.a,{href:\"https://github.com/tantaraio/voy\",children:\"Voy on GitHub\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/tantaraio/voy\",children:\"Voy\"}),\" is an open source semantic search engine in WebAssembly. I created it to empower more projects to build semantic features and create better user experiences for people around the world. Voy follows several design principles:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"\",\"aria-hidden\":!0,children:\"\\u{1F90F}\"}),\" \",(0,n.jsx)(e.strong,{children:\"Tiny\"}),\": Reduce overhead for limited devices, such as mobile browsers with slow network or IoT.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"rocket\",children:\"\\u{1F680}\"}),\" \",(0,n.jsx)(e.strong,{children:\"Fast\"}),\": Create the best search experience for the users.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"deciduous tree\",children:\"\\u{1F333}\"}),\" \",(0,n.jsx)(e.strong,{children:\"Tree Shakable\"}),\": Optimize bundle size and enable asynchronous capabilities for modern Web API, such as Web Workers.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"battery\",children:\"\\u{1F50B}\"}),\" \",(0,n.jsx)(e.strong,{children:\"Resumable\"}),\": Generate portable embeddings index anywhere, anytime.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"cloud\",children:\"\\u2601\\uFE0F\"}),\" \",(0,n.jsx)(e.strong,{children:\"Worldwide\"}),\": Run semantic search on CDN edge servers.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"It's available on npm. You can simply install it with your favorite package manager and you're ready to go.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# with npm\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"npm\"}),` i voy-search\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# with Yarn\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"yarn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),` voy-search\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# with pnpm\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"pnpm\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),` voy-search\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Give it a try and I'm happy to hear from you!\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"references\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#references\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"References\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Foreign_function_interface\",children:\"Foreign function interface\"}),\" - Wikipedia\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/cloudflare/serde-wasm-bindgen\",children:\"serde-wasm-bindgen\"}),\" - GitHub\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/oscartbeaumont/specta\",children:\"Specta\"}),\" - GitHub\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://rustwasm.github.io/wasm-bindgen/api/wasm_bindgen/struct.JsValue.html\",children:\"Struct wasm_bindgen::JsValue\"}),\" - wasm-bindgen\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://rustwasm.github.io/docs/book/introduction.html\",children:\"The Rust and WebAssembly Book\"}),\" - Rust and WebAssembly\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/Aleph-Alpha/ts-rs\",children:\"ts-rs\"}),\" - GitHub\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/madonoharu/tsify\",children:\"Tsify\"}),\" - GitHub\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/1Password/typeshare\",children:\"Typeshare\"}),\" - GitHub\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/tantaraio/voy\",children:\"Voy\"}),\" - GitHub\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://rustwasm.github.io/wasm-bindgen/\",children:\"wasm-bindgen\"}),\" - Rust and WebAssembly\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://rustwasm.github.io/wasm-pack/\",children:\"wasm-pack\"}),\" - Rust and WebAssembly\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://dawchihliou.github.io/articles/wasm-semantic-search-in-rust\",children:\"WASM Semantic Search in Rust\"}),\" - Daw-Chih Liou\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://webassembly.org\",children:\"WebAssembly\"}),\" - WebAssembly.org\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.p,{children:[\"Here you have it! Thanks for reading through \",(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"raising hands\",children:\"\\u{1F64C}\"}),`\nIf you find this article useful, please share it to help more people in their engineering journey.`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"bird\",children:\"\\u{1F426}\"}),\" Feel free to connect with me on \",(0,n.jsx)(e.a,{href:\"https://twitter.com/dawchihliou\",children:\"twitter\"}),\"!\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"\",\"aria-hidden\":!0,children:\"\\u23ED\\uFE0F\"}),\" Ready for the next article? \",(0,n.jsx)(e.span,{role:\"img\",\"aria-label\":\"backhand index pointing right\",children:\"\\u{1F449}\"}),\" \",(0,n.jsx)(e.a,{href:\"/articles/the-last-dockerfile-you-need-for-nestjs\",children:\"The Last Dockerfile You Need for NestJS\"})]}),`\n`,(0,n.jsx)(e.p,{children:\"Happy coding!\"})]})}function w(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,Object.assign({},a,{children:(0,n.jsx)(d,a)})):d(a)}var S=w;return g(v);})();\n;return Component;"},"_id":"articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds.mdx","_raw":{"sourceFilePath":"articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds.mdx","sourceFileName":"share-rust-types-with-typescript-for-webassembly-in-30-seconds.mdx","sourceFileDir":"articles","contentType":"mdx","flattenedPath":"articles/share-rust-types-with-typescript-for-webassembly-in-30-seconds"},"type":"Article","readingTime":{"text":"7 min read","minutes":6.465,"time":387900,"words":1293},"wordCount":1295,"slug":"share-rust-types-with-typescript-for-webassembly-in-30-seconds"}},"__N_SSG":true}